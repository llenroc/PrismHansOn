# 前画面へ戻る  

## TextToSpeechPageViewModel.csの追加

TextToSpeechPageViewModel.csを追加し、以下を実装する  

1. _navigationServiceフィールドの追加  
2. GoBackCommandコマンドの実装  
3. INavigationServiceをインジェクションするコンストラクタの追加  

具体的なコードは以下の通り。
```cs
using Prism.Commands;
using Prism.Mvvm;
using Prism.Navigation;

namespace PrismHansOn.ViewModels
{
    public class TextToSpeechPageViewModel : BindableBase
    {
        private readonly INavigationService _navigationService;

        public DelegateCommand GoBackCommand => new DelegateCommand(() =>
        {
            _navigationService.GoBackAsync();
        });

        public TextToSpeechPageViewModel(INavigationService navigationService)
        {
            _navigationService = navigationService;
        }
    }
}
```

## TextToSpeechPage.xamlの修正  

* ViewModelLocator.AutowireViewModelの有効化  
* 戻るボタンの追加  

変更前  
```xml
<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="PrismHansOn.Views.TextToSpeechPage">
    <ContentPage.Content>
        <StackLayout>
            <Label Text="Welcome to Xamarin Forms!" />
        </StackLayout>
    </ContentPage.Content>
</ContentPage>
```

変更後
```cs
<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:mvvm="clr-namespace:Prism.Mvvm;assembly=Prism.Forms"
             mvvm:ViewModelLocator.AutowireViewModel="True"
             x:Class="PrismHansOn.Views.TextToSpeechPage">
    <ContentPage.Content>
        <StackLayout>
            <Label Text="Welcome to Xamarin Forms!" />
            <Button Text="Go Back" Command="{Binding GoBackCommand}"/>
        </StackLayout>
    </ContentPage.Content>
</ContentPage>
```

## 戻った際にリソースの解放処理を行う  

* IDestructibleインターフェースの実装  

変更後  
```cs
public class TextToSpeechPageViewModel : BindableBase, IDestructible
{
    ...
    public void Destroy()
    {
        // ここで必要に応じて解放処理を行う
        Debug.WriteLine("TextToSpeechPageViewModel#Destroy()");
    }
}
```
